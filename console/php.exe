<?php

require_once '../models/MarvelClient.php';
require_once '../models/Character.php';
require_once '../models/Author.php';

$client = new MarvelClient();
$goOut = false;

while(!$goOut) {
    printf("\n");
    printf("marvel:characters\n");
	printf("marvel:character <id>\n");
    printf("marvel:character-comics <id>\n");
    printf("marvel:comic <id>\n");
    printf("marvel:comic-authors <id>\n");
    printf("exit\n");
    $option = readline("Select a option: \n");

    if(str_word_count($option) == 2 ){
        $option = explode(" ", $option);
        $id = $option[1];
        $option = $option[0];
    }

    switch($option) {
        case "marvel:characters": 
            $characters = $client->getCharacters();

            foreach ($characters as $character) 
            {
                $thumbnail = $character['thumbnail']['path'] . $character['thumbnail']['extension'];
                $charactersArray[] = new Character($character['name'], $character['description'], $thumbnail, $character['comics']);
            }
            getListOfCharacters($charactersArray);
            unset($charactersArray);

        break;

        case "marvel:character":
            $character = $client->getCharacter($id);

            foreach ($character as $charact) 
            {
                $thumbnail = $charact['thumbnail']['path'] . $charact['thumbnail']['extension'];
                $marvelCharacter = new Character($charact['name'], $charact['description'], $thumbnail, $charact['comics']);
            }
            getInformationOfCharacter($marvelCharacter);
            unset($marvelCharacter);

        break;

        case "marvel:character-comics":
            $characterComics = $client->getComicsForCharacter($id);

            foreach ($characterComics as $characterComic) 
            {
                $thumbnail = $characterComic['thumbnail']['path'] . $characterComic['thumbnail']['extension'];
                $authors = $characterComic['creators']['items'];

                if(is_null($characterComic['description'])) $characterComic['description'] = " ";

                $comicsArray[] = new Comic($characterComic['title'], $characterComic['description'], $thumbnail, $authors);
            }
            getInformationOfCharacterComics($comicsArray);
            unset($comicsArray);

        break;

        case "marvel:comic":
            $characterComic = $client->getComic($id);

            foreach ($characterComic as $comic) 
            {
                $thumbnail = $comic['thumbnail']['path'] . $comic['thumbnail']['extension'];
                $authors = $comic['creators']['items'];

                if(is_null($comic['description'])) $comic['description'] = " ";

                $com = new Comic($comic['title'], $comic['description'], $thumbnail, $authors);
            
            }
            getInformationOfComic($com);
            unset($com);
        break;

        case "marvel:comic-authors":
            $comicsCreators = $client->getCreatorsForComics($id);

            foreach ($comicsCreators as $creator) 
            {
                $thumbnail = $creator['thumbnail']['path'] . $creator['thumbnail']['extension'];
                $authors[] = new Author($creator['fullName'], $thumbnail);
            }
            getComicAuthors($authors);
            unset($authors);
        break;

        case "exit": 
            $goOut = true;
        break;

        
    }
}

function getListOfCharacters($charactersArray)
{
    printf("\n");
    printf("List of Marvel Characters: \n");
    foreach ($charactersArray as $character) 
    {
        printf($character->getName() . "\n");
    }
    printf("\n");
}

function getInformationOfCharacter($marvelCharacter)
{
    printf("\n");
    printf("Information about a Marvel character: \n");
    printf("Name: " . $marvelCharacter->getName() . "\n");
    printf("Description: " . $marvelCharacter->getDescription() . "\n");
    printf("\n");
}

function getInformationOfCharacterComics($comics)
{
    printf("\n");
    printf("Comic list of a Marvel character: \n");
    foreach ($comics as $comic) 
    {
        printf($comic->getTitle() . "\n");
    }
    printf("\n");
}

function getInformationOfComic($comic)
{
    printf("\n");
    printf("Information about a Marvel comic character: \n");
    printf("Name: " . $comic->getTitle() . "\n");
    printf("Description: " . $comic->getDescription() . "\n");
    printf("\n");
}

function getComicAuthors($authors)
{
    printf("\n");
    printf("Information about a comic author: \n");
    foreach ($authors as $author) 
    {
        printf($author->getAuthor() . "\n");
    }
    printf("\n");   
}




?>